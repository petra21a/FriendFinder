<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>FriendFinder Survey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Framework References -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/css/materialize.min.css">

</head>

<body class="container">
    <div class="row">
        <div class="col s12">
            <h4>
                Fill out the survey below to find your best-est Friend!
            </h4>

        </div>
        <div class="row">
            <div class="input-field col m6 s12">
                <input id="first_name" type="text" class="validate" pattern="[A-Z][a-z]+" required>
                <label for="first_name" data-error="Please enter a valid name">First Name</label>
            </div>
            <div class="input-field col m6 s12">
                <input id="profile-picture" type="url" class="validate" required>
                <label for="profile-picture" data-error="Please enter a valid url">Link to Photo Image</label>
            </div>

        </div>

        <div>
            <h4>
                For each question choose from a scale which best describes you:
            </h4>

        </div>
        <div class="row flow-text">
            <div class="col m5 offset-m1 s6 left-align">
                <p>
                    Red
                </p>
            </div>
            <div class="col m5 s6 right-align ">
                <p>
                    Green
                </p>
            </div>
        </div>

        <div class="row valign-wrapper">
            <div class="col m8 offset-m2 s12">
                <form action="#">
                    <p class="range-field">
                        <input type="range" id="question1" min="1" max="5" />
                    </p>
                </form>
            </div>
        </div>


        <div class="row flow-text">
            <div class="col m5 offset-m1 s6 left-align">
                <p>
                    Bubbly
                </p>
            </div>
            <div class="col m5 s6 right-align ">
                <p>
                    Surly
                </p>
            </div>
        </div>

        <div class="row valign-wrapper">
            <div class="col m8 offset-m2 s12">
                <form action="#">
                    <p class="range-field">
                        <input type="range" id="question2" min="1" max="5" />
                    </p>
                </form>
            </div>
        </div>

        <div class="row flow-text">
            <div class="col m5 offset-m1 s6 left-align">
                <p>
                    Conservative
                </p>
            </div>
            <div class="col m5 s6 right-align ">
                <p>
                    Adventurous
                </p>
            </div>
        </div>

        <div class="row valign-wrapper">
            <div class="col m8 offset-m2 s12">
                <form action="#">
                    <p class="range-field">
                        <input type="range" id="question3" min="1" max="5" />
                    </p>
                </form>
            </div>
        </div>

        <div class="row flow-text">
            <div class="col m5 offset-m1 s6 left-align">
                <p>
                    Villian
                </p>
            </div>
            <div class="col m5 s6 right-align ">
                <p>
                    Hero
                </p>
            </div>
        </div>

        <div class="row valign-wrapper">
            <div class="col m8 offset-m2 s12">
                <form action="#">
                    <p class="range-field">
                        <input type="range" id="question4" min="1" max="5" />
                    </p>
                </form>
            </div>
        </div>

        <div class="row flow-text">
            <div class="col m5 offset-m1 s6 left-align">
                <p>
                    Young
                </p>
            </div>
            <div class="col m5 s6 right-align ">
                <p>
                    Venerable
                </p>
            </div>
        </div>

        <div class="row valign-wrapper">
            <div class="col m8 offset-m2 s12">
                <form action="#">
                    <p class="range-field">
                        <input type="range" id="question5" min="1" max="5" />
                    </p>
                </form>
            </div>
        </div>

        <div class="row flow-text">
            <div class="col m5 offset-m1 s6 left-align">
                <p>
                    Sly
                </p>
            </div>
            <div class="col m5 s6 right-align ">
                <p>
                    Honest
                </p>
            </div>
        </div>

        <div class="row valign-wrapper">
            <div class="col m8 offset-m2 s12">
                <form action="#">
                    <p class="range-field">
                        <input type="range" id="question6" min="1" max="5" />
                    </p>
                </form>
            </div>
        </div>

        <div class="row flow-text">
            <div class="col m5 offset-m1 s6 left-align">
                <p>
                    Petite
                </p>
            </div>
            <div class="col m5 s6 right-align ">
                <p>
                    Statuesque
                </p>
            </div>
        </div>

        <div class="row valign-wrapper">
            <div class="col m8 offset-m2 s12">
                <form action="#">
                    <p class="range-field">
                        <input type="range" id="question7" min="1" max="5" />
                    </p>
                </form>
            </div>
        </div>

        <div class="row flow-text">
            <div class="col m5 offset-m1 s6 left-align">
                <p>
                    Bold
                </p>
            </div>
            <div class="col m5 s6 right-align ">
                <p>
                    Hubble
                </p>
            </div>
        </div>

        <div class="row valign-wrapper">
            <div class="col m8 offset-m2 s12">
                <form action="#">
                    <p class="range-field">
                        <input type="range" id="question8" min="1" max="5" />
                    </p>
                </form>
            </div>
        </div>

        <div class="row flow-text">
            <div class="col m5 offset-m1 s6 left-align">
                <p>
                    Jumper
                </p>
            </div>
            <div class="col m5 s6 right-align ">
                <p>
                    Swimmer
                </p>
            </div>
        </div>

        <div class="row valign-wrapper">
            <div class="col m8 offset-m2 s12">
                <form action="#">
                    <p class="range-field">
                        <input type="range" id="question9" min="1" max="5" />
                    </p>
                </form>
            </div>
        </div>

        <div class="row flow-text">
            <div class="col m5 offset-m1 s6 left-align">
                <p>
                    Human
                </p>
            </div>
            <div class="col m5 s6 right-align ">
                <p>
                    Other
                </p>
            </div>
        </div>

        <div class="row valign-wrapper">
            <div class="col m8 offset-m2 s12">
                <form action="#">
                    <p class="range-field">
                        <input type="range" id="question10" min="1" max="5" />
                    </p>
                </form>
            </div>
        </div>

        <div id="validate-modal" class="modal">
            <div class="modal-content">
                <h4>Oops!</h4>
                <p>You need to enter a valid name and picture to proceed. We are all friends here!
                </p>
            </div>
        </div>

        <div id="friend-modal" class="modal">
            <div class="modal-content">
                <div class="card">
                    <div class="card-image waves-effect waves-block waves-light">
                        <img class="activator" src="http://cholesterolcode.com/wp-content/uploads/2017/12/curtains_question_mark.png">
                    </div>
                    <div class="card-content">
                        <span class="card-title activator grey-text text-darken-4">You're New Best Friend is...
                            <i class="material-icons right">more_vert</i>
                        </span>

                    </div>
                    <div class="card-reveal">
                        <span class="card-title grey-text text-darken-4">
                            <h2 id="friend-name"></h2>
                            <i class="material-icons right">close</i>
                        </span>
                        <img id="friend-image" src="">
                    </div>
                </div>
            </div>
        </div>

        <div class="row col s12 center-align">


            <a id="get-friend-btn" class="waves-effect waves-light btn-large" href="#">
                <i class="material-icons left">insert_emoticon</i>See Your Match!</a>
        </div>

    </div>

    <footer class="footer row center-align">
        <p>
            <a href="/api/friends">API Friends List</a> |
            <a href="/">Home</a>
        </p>
    </footer>
</body>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/js/materialize.min.js"></script>
<script type="text/javascript">



    $('.modal').modal();
    // Constructs new Friend from survey input
    //Borrowed from StarWars code
    $("#get-friend-btn").on("click", function (event) {
        //prevents page reload on submit click by default
        event.preventDefault();
        if ($("#first_name")[0].validity.valid === false || $("#profile-picture")[0].validity.valid === false) {
            $('#validate-modal').modal('open');
        } else {
            // $("#get-friend-btn").attr("href", "#bestFriend-modal");
            const newFriend = {
                name: $("#first_name").val().trim(),
                photo: $("#profile-picture").val().trim(),
                scores: [parseInt($("#question1").val(), 10),
                parseInt($("#question2").val(), 10),
                parseInt($("#question3").val(), 10),
                parseInt($("#question4").val(), 10),
                parseInt($("#question5").val(), 10),
                parseInt($("#question6").val(), 10),
                parseInt($("#question7").val(), 10),
                parseInt($("#question8").val(), 10),
                parseInt($("#question9").val(), 10),
                parseInt($("#question10").val(), 10),
                ]

            };

            // Question: What does this code do??
            $.post("/api/friends", newFriend).then(function (data) {
                console.log(data)
                $("#friend-name").html(data.name);
                $("#friend-image").attr("src", data.photo);
                $('#friend-modal').modal('open');

            });
        }
    });

</script>

</html>